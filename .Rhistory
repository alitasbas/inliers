diffs_table <- as.data.frame(diffs_table)
diffs_table$difference <- as.double(rownames(diffs_table))
colnames(diffs_table) <- c("frequency", "difference")
threshold <- diffs_table[3, 2]
binary_diffs <- as.integer(diffs <= threshold) # 1 if the distance < threshold
# Find the number of connected data points
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
c_size <- 0
next_point_index <- n-1
for (point_index in 1:(n-1)) {
cat("checking index", point_index, "\n")
if (point_index <= next_point_index) {
next
}
if (binary_diffs[point_index] == 1) {
for (next_point_index in (point_index + 1): (n-1)) {
cat("Matched. Now checking trailing indexes", next_point_index, "\n")
print(binary_diffs[next_point_index:(next_point_index + 2)])
print(sum(binary_diffs[next_point_index:(next_point_index + 2)]))
if (sum(binary_diffs[next_point_index:(next_point_index + 2)]) == 0) {
cluster_boundaries <- c(point_index, (next_point_index - 1))
cat("cluster_boundaries: ", cluster_boundaries, "\n")
c_size <- sum(binary_diffs[point_index: next_point_index])
if (c_size < 3) {
cat("skipped at", point_index, "\n")
}
else {
clusters_df <- add_row(clusters_df,
lower_boundary=point_index,
upper_boundary=next_point_index - 1,
cluster_size = c_size)
}
break
}
} # end of for(next_point_index) loop
}
}
return(clusters_df)
}
clusters(normal_sample)
clusters <- function(sample) {
n <- length(sample)
sample <- sort(sample)
diffs <- diff(sample)
# Find the ideal diff length
round_index <- 5
for (i in round_index:-5) {
if (between(as.matrix(table(round(diffs, i)))[1], 0.08 * n, 0.12 * n)) {
round_index <- i
print(round_index)
break
}
}
diffs_table <- as.matrix(table(round(diffs, round_index)))
diffs_table <- as.data.frame(diffs_table)
diffs_table$difference <- as.double(rownames(diffs_table))
colnames(diffs_table) <- c("frequency", "difference")
threshold <- diffs_table[3, 2]
binary_diffs <- as.integer(diffs <= threshold) # 1 if the distance < threshold
# Find the number of connected data points
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
c_size <- 0
next_point_index <- 0
for (point_index in 1:(n-1)) {
cat("checking index", point_index, "\n")
if (point_index <= next_point_index) {
next
}
if (binary_diffs[point_index] == 1) {
for (next_point_index in (point_index + 1): (n-1)) {
cat("Matched. Now checking trailing indexes", next_point_index, "\n")
print(binary_diffs[next_point_index:(next_point_index + 2)])
print(sum(binary_diffs[next_point_index:(next_point_index + 2)]))
if (sum(binary_diffs[next_point_index:(next_point_index + 2)]) == 0) {
cluster_boundaries <- c(point_index, (next_point_index - 1))
cat("cluster_boundaries: ", cluster_boundaries, "\n")
c_size <- sum(binary_diffs[point_index: next_point_index])
if (c_size < 3) {
cat("skipped at", point_index, "\n")
}
else {
clusters_df <- add_row(clusters_df,
lower_boundary=point_index,
upper_boundary=next_point_index - 1,
cluster_size = c_size)
}
break
}
} # end of for(next_point_index) loop
}
}
return(clusters_df)
}
clusters(normal_sample)
x <- clusters(normal_sample)
x
clusters <- function(sample) {
n <- length(sample)
sample <- sort(sample)
diffs <- diff(sample)
# Find the ideal diff length
round_index <- 5
for (i in round_index:-5) {
if (between(as.matrix(table(round(diffs, i)))[1], 0.08 * n, 0.12 * n)) {
round_index <- i
print(round_index)
break
}
}
diffs_table <- as.matrix(table(round(diffs, round_index)))
diffs_table <- as.data.frame(diffs_table)
diffs_table$difference <- as.double(rownames(diffs_table))
colnames(diffs_table) <- c("frequency", "difference")
threshold <- diffs_table[3, 2]
binary_diffs <- as.integer(diffs <= threshold) # 1 if the distance < threshold
# Find the number of connected data points
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
c_size <- 0
next_point_index <- 0
for (point_index in 1:(n-1)) {
cat("checking index", point_index, "\n")
if (point_index <= next_point_index) {
next
}
if (binary_diffs[point_index] == 1) {
for (next_point_index in (point_index + 1): (n-1)) {
cat("Matched. Now checking trailing indexes", next_point_index, "\n")
print(binary_diffs[next_point_index:(next_point_index + 2)])
print(sum(binary_diffs[next_point_index:(next_point_index + 2)]))
if (sum(binary_diffs[next_point_index:(next_point_index + 2)]) == 0) {
cluster_boundaries <- c(point_index, (next_point_index - 1))
cat("cluster_boundaries: ", cluster_boundaries, "\n")
c_size <- sum(binary_diffs[cluster_boundaries[1]: cluster_boundaries[2]])
if (c_size < 3) {
cat("skipped at", point_index, "\n")
}
else {
print("Adding to dataframe")
clusters_df <- add_row(clusters_df,
lower_boundary=cluster_boundaries[1],
upper_boundary=cluster_boundaries[2],
cluster_size = c_size)
}
break
}
} # end of for(next_point_index) loop
}
}
return(clusters_df)
}
x <- clusters(normal_sample)
x
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
clusters_df
clusters_df <- add_row(clusters_df,
lower_boundary=31,
upper_boundary=69,
cluster_size = 3)
clusters_df
clusters_df <- add_row(clusters_df,
lower_boundary=31,
upper_boundary=69,
cluster_size = 5)
clusters_df
clusters <- function(sample) {
n <- length(sample)
sample <- sort(sample)
diffs <- diff(sample)
# Find the ideal diff length
round_index <- 5
for (i in round_index:-5) {
if (between(as.matrix(table(round(diffs, i)))[1], 0.08 * n, 0.12 * n)) {
round_index <- i
print(round_index)
break
}
}
diffs_table <- as.matrix(table(round(diffs, round_index)))
diffs_table <- as.data.frame(diffs_table)
diffs_table$difference <- as.double(rownames(diffs_table))
colnames(diffs_table) <- c("frequency", "difference")
threshold <- diffs_table[3, 2]
binary_diffs <- c(as.integer(diffs <= threshold), 0, 0) # 1 if the distance < threshold
# Find the number of connected data points
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
c_size <- 0
next_point_index <- 0
for (point_index in 1:(n-1)) {
cat("checking index", point_index, "\n")
if (point_index <= next_point_index) {
next
}
if (binary_diffs[point_index] == 1) {
for (next_point_index in (point_index + 1): (n-1)) {
cat("Matched. Now checking trailing indexes", next_point_index, "\n")
print(binary_diffs[next_point_index:(next_point_index + 2)])
print(sum(binary_diffs[next_point_index:(next_point_index + 2)]))
if (sum(binary_diffs[next_point_index:(next_point_index + 2)]) == 0) {
cluster_boundaries <- c(point_index, (next_point_index - 1))
cat("cluster_boundaries: ", cluster_boundaries, "\n")
c_size <- sum(binary_diffs[cluster_boundaries[1]: cluster_boundaries[2]])
if (c_size < 3) {
cat("skipped at", point_index, "\n")
}
else {
print("Adding to dataframe")
clusters_df <- add_row(clusters_df,
lower_boundary=cluster_boundaries[1],
upper_boundary=cluster_boundaries[2],
cluster_size = c_size)
}
break
}
} # end of for(next_point_index) loop
}
}
return(clusters_df)
}
x <- clusters(normal_sample)
x
source("utils.R")
setwd("D:/ODTU/Sem 7/STAT 499/R")
source("D:/ODTU/Sem 7/STAT 499/R/inlier_generation.R", echo=TRUE)
setwd("D:/ODTU/Sem 7/STAT 499/R")
source("utils.R")
set.seed(499)
View(fx)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.75)
hist(norm_sample)
hist(norm_sample)
hist(Nidali_sample)
hist(akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
exp_sample <- rexp(1000, rate=1/30)
Nidali_exp_sample <- inject_inlier(exp_sample, 30, 1, 0.1, min=28, max=31.5)
akkaya_exp_sample <- generate_contaminated_data(exp_sample, delta=0.8)
hist(exp_sample)
hist(exp_sample)
hist(Nidali_exp_sample)
hist(akkaya_exp_sample)
compare_dists(exp_sample, Nidali_exp_sample)
compare_dists(exp_sample, akkaya_exp_sample)
exam_score_df <- read.csv("data/student_exam_scores.csv")
scores <- exam_score_df$exam_score
hist(scores)
nidali_contaminated_scores <- inject_inlier(scores, mu=20, sigma = 4, ratio = 0.07, min = 15, max = 25)
akkaya_contaminated_scores <- generate_contaminated_data(scores, delta = 0.75)
plot(density(scores))
plot(density(nidali_contaminated_scores))
plot(density(akkaya_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
compare_dists(scores, akkaya_contaminated_scores)
hist(scores)
plot(density(scores))
mean(scores)
plot(density(nidali_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
nidali_contaminated_scores <- inject_inlier(scores, mu=33, sigma = 4, ratio = 0.1, min = 20, max = 40)
compare_dists(scores, nidali_contaminated_scores)
library(moments)
kurtosis(nidali_contaminated_scores)
nidali_contaminated_scores <- inject_inlier(scores, mu=20, sigma = 4, ratio = 0.07, min = 15, max = 25)
kurtosis(nidali_contaminated_scores)
kurtosis(akkaya_contaminated_scores)
kurtosis(scores)
compare_dists(scores, akkaya_contaminated_scores)
kurtosis(akkaya_contaminated_scores)
plot(density(nidali_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
kurtosis(nidali_contaminated_scores)
nidali_contaminated_scores <- inject_inlier(scores, mu=43, sigma = 4, ratio = 0.07, min = 40, max = 45)
plot(density(nidali_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
kurtosis(nidali_contaminated_scores)
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.75)
hist(norm_sample)
hist(norm_sample)
hist(Nidali_sample)
hist(akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(c(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(list(exp_sample, Nidali_exp_sample, akkaya_exp_sample), kurtosis)
sapply(list(scores, nidali_contaminated_scores, akkaya_contaminated_scores), kurtosis)
nidali_contaminated_scores <- inject_inlier(scores, mu=34, sigma = 4, ratio = 0.07, min = 30, max = 39)
akkaya_contaminated_scores <- generate_contaminated_data(scores, delta = 0.75)
plot(density(scores))
plot(density(nidali_contaminated_scores))
plot(density(akkaya_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
compare_dists(scores, akkaya_contaminated_scores)
sapply(list(scores, nidali_contaminated_scores, akkaya_contaminated_scores), kurtosis)
qqnorm(akkaya_contaminated_scores)
qqnorm(scores)
qqnorm(akkaya_contaminated_scores)
qqnorm(scores)
qqnorm(nidali_contaminated_scores)
qqnorm(akkaya_contaminated_scores)
qqnorm(scores)
qqnorm(akkaya_contaminated_scores)
sapply(list(scores, nidali_contaminated_scores, akkaya_contaminated_scores), kurtosis)
qqnorm(scores)
qqnorm(nidali_contaminated_scores)
qqnorm(akkaya_contaminated_scores)
sapply(list(scores, nidali_contaminated_scores, akkaya_contaminated_scores), kurtosis)
qqnorm(scores)
qqnorm(nidali_contaminated_scores)
qqnorm(akkaya_contaminated_scores)
qqplot(scores, nidali_contaminated_scores)
qqnorm(scores, akkaya_contaminated_scores)
qqnorm(scores, akkaya_contaminated_scores)
qqplot(scores, nidali_contaminated_scores)
qqnorm(scores, akkaya_contaminated_scores)
qqplot(scores, akkaya_contaminated_scores)
qqplot(scores, nidali_contaminated_scores)
qqplot(scores, akkaya_contaminated_scores)
exam_score_df <- read.csv("data/student_exam_scores.csv")
scores <- exam_score_df$exam_score
hist(scores)
nidali_contaminated_scores <- inject_inlier(scores, mu=34, sigma = 4, ratio = 0.07, min = 30, max = 39)
akkaya_contaminated_scores <- generate_contaminated_data(scores, delta = 0.75)
plot(density(scores))
plot(density(nidali_contaminated_scores))
plot(density(akkaya_contaminated_scores))
compare_dists(scores, nidali_contaminated_scores)
sapply(list(scores, nidali_contaminated_scores, akkaya_contaminated_scores), kurtosis)
compare_dists(scores, akkaya_contaminated_scores)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.75)
hist(norm_sample)
hist(norm_sample)
hist(Nidali_sample)
hist(akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.75)
hist(norm_sample)
hist(norm_sample)
hist(Nidali_sample)
hist(akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
hist(norm_sample)
hist(Nidali_sample)
hist(akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
compare_dists(norm_sample, Nidali_sample)
quantile(norm_sample, 0.25)
summary(norm_sample)
quantile(norm_sample, 0.75)
inject_inlier <- function(original_data, ratio=0.1) {
n <- length(original_data)
inlier_count <- n * ratio
q1 <- quantile(original_data, 0.25)
q3 <- quantile(original_data, 0.75)
replicable_sample <- original_data[between(original_data, q1, q3)]
replacable_sample <- original_data[(original_data < q1) | (original_data > q3)]
inliers <- sample(replicable_sample, inlier_count, replace=FALSE)
replacable_sample[sample(length(replacable_sample, inlier_count, replace=F))] <- inliers
new_sample <- c(replicable_sample, replacable_sample)
return(contaminated_sample)
}
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
inject_inlier <- function(original_data, ratio=0.1) {
n <- length(original_data)
inlier_count <- n * ratio
q1 <- quantile(original_data, 0.25)
q3 <- quantile(original_data, 0.75)
replicable_sample <- original_data[between(original_data, q1, q3)]
replacable_sample <- original_data[(original_data < q1) | (original_data > q3)]
inliers <- sample(replicable_sample, inlier_count, replace=FALSE)
replacable_sample[sample(length(replacable_sample), inlier_count, replace=F)] <- inliers
new_sample <- c(replicable_sample, replacable_sample)
return(contaminated_sample)
}
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
inject_inlier <- function(original_data, ratio=0.1) {
n <- length(original_data)
inlier_count <- n * ratio
q1 <- quantile(original_data, 0.25)
q3 <- quantile(original_data, 0.75)
replicable_sample <- original_data[between(original_data, q1, q3)]
replacable_sample <- original_data[(original_data < q1) | (original_data > q3)]
inliers <- sample(replicable_sample, inlier_count, replace=FALSE)
replacable_sample[sample(length(replacable_sample), inlier_count, replace=FALSE)] <- inliers
new_sample <- c(replicable_sample, replacable_sample)
return(contaminated_sample)
}
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
inject_inlier <- function(original_data, ratio=0.1) {
n <- length(original_data)
inlier_count <- n * ratio
q1 <- quantile(original_data, 0.25)
q3 <- quantile(original_data, 0.75)
replicable_sample <- original_data[between(original_data, q1, q3)]
replacable_sample <- original_data[(original_data < q1) | (original_data > q3)]
inliers <- sample(replicable_sample, inlier_count, replace=FALSE)
replacable_sample[sample(length(replacable_sample), inlier_count, replace=FALSE)] <- inliers
contaminated_sample <- c(replicable_sample, replacable_sample)
return(contaminated_sample)
}
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
hist(new_sample)
compare_dists(norm_sample, new_sample)
kurtosis(norm_sample)
kurtosis(new_sample)
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
hist(norm_sample)
hist(new_sample)
hist(norm_sample)
hist(new_sample)
hist(norm_sample)
hist(new_sample)
compare_dists(norm_sample, new_sample)
kurtosis(new_sample)
kurtosis(norm_sample)
inject_inlier <- function(original_data, ratio=0.1) {
n <- length(original_data)
inlier_count <- n * ratio
q1 <- quantile(original_data, 0.25)
q3 <- quantile(original_data, 0.75)
replicable_sample <- original_data[between(original_data, q1, q3)]
left_replacable_sample <- original_data[(original_data < q1)]
right_replacable_sample <- original_data[(original_data > q3)]
inliers <- sample(replicable_sample, inlier_count, replace=FALSE)
left_replacable_sample[sample(length(left_replacable_sample), inlier_count / 2, replace=FALSE)] <- inliers
right_replacable_sample[sample(length(right_replacable_sample), inlier_count / 2, replace=FALSE)] <- inliers
contaminated_sample <- c(replicable_sample, replacable_sample)
return(contaminated_sample)
}
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
hist(norm_sample)
hist(norm_sample)
hist(new_sample)
hist(new_sample)
compare_dists(norm_sample, new_sample)
