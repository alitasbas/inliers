compare_dists(norm_sample, akkaya_sample)
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
sapply(lsit(norm_sample, new_sample, akkaya_sample), length)
sapply(list(norm_sample, new_sample, akkaya_sample), length)
c(1, 2, 3, 4,5 ,6 7, 8, 9, 0, )
c(1, 2, 3, 4,5 ,6, 7, 8, 9, 0, )
c(1, 2, 3, 4,5 ,6, 7, 8, 9, 0, 11)
c(1, 2, 3, 4,5 ,6, 7, 8, 9, 0, 11)[1:2]
c(1, 2, 3, 4,5 ,6, 7, 8, 9, 0, 11)[1:]
c(1, 2, 3, 4,5 ,6, 7, 8, 9, 0, 11)[:2]
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
clusters(norm_sample)
c <- clusters(norm_sample)
c
source("utils.R")
clusters(norm_sample)
s <- norm_sample
sample <- norm_sample
n <- length(sample)
sample <- sort(sample)
diffs <- diff(sample)
between(as.matrix(table(round(diffs, i)))[1], 0.075 * n, 0.125 * n)
between(as.matrix(table(round(diffs, 5)))[1], 0.075 * n, 0.125 * n)
between(as.matrix(table(round(diffs, 3)))[1], 0.075 * n, 0.125 * n)
between(as.matrix(table(round(diffs, 2)))[1], 0.075 * n, 0.125 * n)
between(as.matrix(table(round(diffs, 1)))[1], 0.075 * n, 0.125 * n)
as.matrix(table(round(diffs, 1)))
as.matrix(table(round(diffs, 2)))
as.matrix(table(round(diffs, 3)))
as.matrix(table(round(diffs, 2)))
clusters <- function(sample) {
n <- length(sample)
sample <- sort(sample)
diffs <- diff(sample)
# Find the ideal diff length
round_index <- 5
for (i in round_index:-5) {
if (between(as.matrix(table(round(diffs, i)))[1], 0.1 * n, 0.2 * n)) {
round_index <- i
print(round_index)
break
}
}
diffs_table <- as.matrix(table(round(diffs, round_index)))
diffs_table <- as.data.frame(diffs_table)
diffs_table$difference <- as.double(rownames(diffs_table))
colnames(diffs_table) <- c("frequency", "difference")
threshold <- diffs_table[3, 2]
binary_diffs <- c(as.integer(diffs <= threshold), 0, 0) # 1 if the distance < threshold
# Find the number of connected data points
clusters_df <- data.frame(lower_boundary = numeric(0),
upper_boundary = numeric(0),
cluster_size = numeric(0))
c_size <- 0
next_point_index <- 0
for (point_index in 1:(n-1)) {
cat("checking index", point_index, "\n")
if (point_index <= next_point_index) {
next
}
if (binary_diffs[point_index] == 1) {
for (next_point_index in (point_index + 1): (n-1)) {
cat("Matched. Now checking trailing indexes", next_point_index, "\n")
print(binary_diffs[next_point_index:(next_point_index + 2)])
print(sum(binary_diffs[next_point_index:(next_point_index + 2)]))
if (sum(binary_diffs[next_point_index:(next_point_index + 2)]) == 0) {
cluster_boundaries <- c(point_index, (next_point_index - 1))
cat("cluster_boundaries: ", cluster_boundaries, "\n")
c_size <- sum(binary_diffs[cluster_boundaries[1]: cluster_boundaries[2]])
if (c_size < 3) {
cat("skipped at", point_index, "\n")
}
else {
print("Adding to dataframe")
clusters_df <- add_row(clusters_df,
lower_boundary=cluster_boundaries[1],
upper_boundary=cluster_boundaries[2],
cluster_size = c_size)
}
break
}
} # end of for(next_point_index) loop
}
}
return(clusters_df)
}
as.matrix(table(round(diffs, 2)))
clusters(norm_sample)
round_index <- 2
diffs_table <- as.matrix(table(round(diffs, round_index)))
diffs_table
diffs_table <- as.data.frame(diffs_table)
diffs_table
diffs_table$difference <- as.double(rownames(diffs_table))
diffs_table
threshold <- diffs_table[3, 2]
threshold
threshold <- diffs_table[2, 2]
binary_diffs <- c(as.integer(diffs <= threshold), 0, 0) # 1 if the distance < threshold
binary_diffs
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
kurtosis(norm_sample)
kurtosis(new_sample)
kurtosis(akkaya_sample)
exp_sample <- rexp(1000, rate=1/30)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_norm
c_new
c_akkaya
new_sample <- sort(new_sample)
diffs <- diff(new_sample)
as.matrix(table(round(diffs, 3)))
as.matrix(table(round(diff(sort(norm_sample)), 3)))
as.matrix(table(round(diff(sort(new_sample)), 3)))
as.matrix(table(round(diff(sort(new_sample)), 2)))
as.matrix(table(round(diff(sort(norm_sample)), 2)))
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_norm
c_new
c_akkaya <- clusters(akkaya_sample)
c_akkaya
c_new
c_norm
write.csv(c_new, row.names = F)
write.csv(c_new, "NIDALI.csv", row.names = F)
write.csv(c_norm, "norm.csv", row.names = F)
write.csv(c_akkaya, "akkaya.csv", row.names = F)
write.csv(norm_akkaya, "akkaya.csv", row.names = F)
write.csv(akkaya_sample, "akkaya.csv", row.names = F)
write.csv(new_sample, "nidali.csv", row.names = F)
write.csv(norm_sample, "norm.csv", row.names = F)
write.csv(norm_sample, "norm.csv", row.names = F)
clusters(norm_sample)
norm_sample
diff(norm_sample)
clusters(norm_sample)
c_norm
c_new
sort(norm_sample)
diff(sort(norm_sample))
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_akkaya
c_new
c_norm
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_akkaya
c_new
c_norm
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
shapiro.test(norm_sample)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_norm
c_new
c_akkaya
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
norm_sample <- rnorm(300)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_norm
c_new
c_akkaya
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
compare_dists(norm_sample, akkaya_sample)
# Kurtosis
sapply(list(norm_sample, new_sample, akkaya_sample), kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(new_sample)
c_akkaya <- clusters(akkaya_sample)
c_akkaya
c_new
c_norm
setwd("D:/ODTU/Sem 7/STAT 499/R")
library(moments)
source("utils.R")
set.seed(499)
norm_sample <- rnorm(100)
# Nidali_sample <- inject_inlier(norm_sample, 0.5, 0.75, 0.1, min=-0.375, max=0.375)
new_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample)
# hist(norm_sample)
hist(new_sample)
hist(akkaya_sample)
# compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, new_sample)
# hist(norm_sample)
hist(new_sample, col="darkpurple")
# hist(norm_sample)
hist(new_sample, col="darkmagenta")
# hist(norm_sample)
hist(new_sample, col="lightblue")
# hist(norm_sample)
hist(new_sample, col="blue")
light
# hist(norm_sample)
hist(new_sample, col="lightblue")
hist(norm_sample, col="lightblue")
lines(density(norm_sample), col="darkmagenta")
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta")
lines(density(norm_sample), col="darkmagenta", linewidth=3)
lines(density(norm_sample), col="darkmagenta", lwidth=3)
lines(density(norm_sample), col="darkmagenta", lwd=3)
set.seed(499)
norm_sample <- rnorm(100)
Nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
akkaya_sample <- generate_contaminated_data(norm_sample, delta = 0.01)
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
hist(Nidali_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
hist(akkaya_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
compare_dists(norm_sample, Nidali_sample)
compare_dists(norm_sample, akkaya_sample)
compare_dists(norm_sample, Nidali_sample)
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
hist(Nidali_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
hist(akkaya_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
# Kurtosis
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
summary(norm_sample)
summary(Nidali_sample)
str(norm_sample)
# Kurtosis
sapply(list(norm_sample, Nidali_sample, akkaya_sample), kurtosis)
summary(Nidali_sample)
summary(Nidali_sample)[1]
class(summary(Nidali_sample)[1])
class(summary(Nidali_sample))
class(values(summary(Nidali_sample)))
x <- data.frame()
y <- summary(Nidali_sample)
rbind(x, y)
x <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
x
x <- data.frame(q1 = c(1), median = c(2),
xbar = c(3), q3 = c(4),
kurtosis = c(2))
x
x <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
bind_rows(x, summary(Nidali_sample))
x <- bind_rows(x, summary(Nidali_sample))
x <- bind_rows(x, summary(norm_sample))
x
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
bind_row(norm_summary_df, summary(norm_sample))
hist(nidali_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
bind_row(nidali_summary_df, summary(nidali_summary_df))
}
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
bind_rows(norm_summary_df, summary(norm_sample))
hist(nidali_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
bind_rows(nidali_summary_df, summary(nidali_summary_df))
}
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
hist(norm_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
hist(nidali_sample, col="lightblue", freq=F)
lines(density(norm_sample), col="darkmagenta", lwd=3)
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
}
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
}
norm_summary_df
set.seed(499)
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
}
colMeans(norm_summary_df)
colMeans(nidali_summary_df)
set.seed(499)
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
nidali_kurtosis <- c()
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_kurtosis <- c()
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
norm_kurtosis <- c(norm_kurtosis, kurtosis(norm_sample))
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
nidali_kurtosis <- c(nidali_kurtosis, kurtosis(nidali))
}
set.seed(499)
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
nidali_kurtosis <- c()
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_kurtosis <- c()
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
norm_kurtosis <- c(norm_kurtosis, kurtosis(norm_sample))
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
nidali_kurtosis <- c(nidali_kurtosis, kurtosis(nidali_sample))
}
set.seed(499)
nidali_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
nidali_kurtosis <- c()
norm_summary_df <- data.frame(q1 = c(), median = c(),
xbar = c(), q3 = c(),
kurtosis = c())
norm_kurtosis <- c()
for (i in 1:1000) {
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
norm_summary_df <- bind_rows(norm_summary_df, summary(norm_sample))
norm_kurtosis <- c(norm_kurtosis, kurtosis(norm_sample))
nidali_summary_df <- bind_rows(nidali_summary_df, summary(nidali_sample))
nidali_kurtosis <- c(nidali_kurtosis, kurtosis(nidali_sample))
}
colMeans(norm_summary_df)
mean(norm_kurtosis)
mean(nidali_kurtosis)
# Clusters
c_norm <- clusters(norm_sample)
c_norm
c_new <- clusters(nidali_sample)
c_new
c_norm
norm_sample <- rnorm(100)
nidali_sample <- inject_inlier(original_data=norm_sample, 0.1)
# Clusters
c_norm <- clusters(norm_sample)
c_new <- clusters(nidali_sample)
c_norm
c_new
